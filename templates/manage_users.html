<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manage Users (HOD)</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen">
    <header class="bg-blue-600 text-white p-6 w-full">
        <div class="container mx-auto flex flex-col md:flex-row md:justify-between md:items-center text-center md:text-left">
            <div class="flex flex-col md:flex-row md:items-center w-full justify-center md:justify-start">
                <img src="{{ url_for('static', filename='images/vishnu-logo.jpg') }}" alt="Institute logo" class="mx-auto md:mr-4 mb-2 md:mb-0" width="50" height="50" />
                <div class="flex flex-col items-center md:items-start w-full">
                    <h1 class="text-2xl font-bold">Vishnu Institute Of Technology</h1>
                    <h2 class="text-base md:text-lg">Bhimavaram, West Godavari District</h2>
                    <h2 class="text-base md:text-lg">Affiliated to JNTUK</h2>
                    <h2 class="text-base md:text-lg">Accredited by NAAC 'A+'</h2>
                    <h2 class="text-base md:text-lg">Approved by AICTE</h2>
                </div>
            </div>
        </div>
    </header>
    <div class="bg-white p-8 rounded-lg shadow-lg w-full max-w-3xl mx-auto mt-8">
        <h2 class="text-2xl font-bold mb-6 text-center">Manage Users</h2>
        <!-- Filtering Form -->
        <form method="GET" action="{{ url_for('manage_users_hods') }}" class="flex flex-col md:flex-row gap-4 mb-6 justify-center items-center">
            <div>
                <label for="filter_user_type" class="block mb-1 font-semibold">Filter by User Type</label>
                <select class="border border-gray-300 rounded-lg px-3 py-2" id="filter_user_type" name="user_type">
                    <option value="">All</option>
                    <option value="faculty" {% if user_type_filter == 'faculty' %}selected{% endif %}>Faculty</option>
                    <option value="dept" {% if user_type_filter == 'dept' %}selected{% endif %}>Department</option>
                    <option value="studentclubs" {% if user_type_filter == 'studentclubs' %}selected{% endif %}>Student Clubs</option>
                    <option value="startups" {% if user_type_filter == 'startups' %}selected{% endif %}>Startups</option>
                    <option value="students" {% if user_type_filter == 'students' %}selected{% endif %}>Student</option>
                    <option value="hods" {% if user_type_filter == 'hods' %}selected{% endif %}>HOD</option>
                </select>
            </div>
            <div>
                <label for="filter_user_id" class="block mb-1 font-semibold">Filter by User ID</label>
                <input type="text" class="border border-gray-300 rounded-lg px-3 py-2" id="filter_user_id" name="user_id" value="{{ user_id_filter or '' }}">
            </div>
            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Filter</button>
        </form>
        <!-- Update Form -->
        <form method="POST" action="{{ url_for('update_user_hods') }}" class="space-y-5">
            <div>
                <label for="user_type" class="block mb-1 font-semibold">User Type</label>
                <select class="w-full border border-gray-300 rounded-lg px-3 py-2" id="user_type" name="user_type" required>
                    <option value="dept">Department</option>
                    <option value="faculty">Faculty</option>
                    <option value="studentclubs">Student Clubs</option>
                    <option value="startups">Startups</option>
                    <option value="students">Student</option>
                    <option value="hods">HOD</option>
                </select>
            </div>
            <div>
                <label for="user_id" class="block mb-1 font-semibold">User ID</label>
                <input type="text" class="w-full border border-gray-300 rounded-lg px-3 py-2" id="user_id" name="user_id" value="{{ user.user_id if user and user.user_type == 'faculty' else '' }}" required>
            </div>
            <div>
                <label for="password" class="block mb-1 font-semibold">Password</label>
                <input type="text" class="w-full border border-gray-300 rounded-lg px-3 py-2" id="password" name="password" value="{{ user.password if user and user.user_type == 'faculty' else '' }}" required>
            </div>
            <div id="faculty_extra" style="display:none;">
                <label for="faculty_name" class="block mb-1 font-semibold">Faculty Name</label>
                <input type="text" class="w-full border border-gray-300 rounded-lg px-3 py-2" id="faculty_name" name="faculty_name" value="{{ user.faculty_name if user and user.user_type == 'faculty' else '' }}">
                <label for="department" class="block mb-1 font-semibold mt-2">Department</label>
                <input type="text" class="w-full border border-gray-300 rounded-lg px-3 py-2" id="department" name="department" value="{{ user.department if user and user.user_type == 'faculty' else '' }}">
            </div>
            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Update User</button>
        </form>
        <div class="mt-8">
            <h3 class="text-xl font-bold mb-4 text-center">All Users</h3>
            <div class="overflow-x-auto">
                <table class="min-w-full border border-gray-300">
                    <thead>
                        <tr class="bg-gray-100">
                            <th class="px-4 py-2 border">User Type</th>
                            <th class="px-4 py-2 border">User ID</th>
                            <th class="px-4 py-2 border">Password</th>
                            <th class="px-4 py-2 border">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for user in users %}
                        <tr>
                            <td class="px-4 py-2 border">{{ user.user_type }}</td>
                            <td class="px-4 py-2 border">{{ user.user_id }}</td>
                            <td class="px-4 py-2 border">{{ user.password }}</td>
                            <td class="px-4 py-2 border">
                                {% if user.user_type == 'faculty' %}
                                <form method="POST" action="{{ url_for('update_user_hods') }}" style="display:inline;">
                                    <input type="hidden" name="user_id" value="{{ user.user_id }}">
                                    <input type="hidden" name="user_type" value="{{ user.user_type }}">
                                    <input type="text" name="faculty_name" value="{{ user.faculty_name }}" placeholder="Faculty Name" class="border rounded px-2 py-1 mr-1" required>
                                    <select name="department" class="border rounded px-2 py-1 mr-1" required>
                                        <option value="AI & ML" {% if user.department == 'AI & ML' %}selected{% endif %}>AI & ML</option>
                                        <option value="AI & DS" {% if user.department == 'AI & DS' %}selected{% endif %}>AI & DS</option>
                                        <option value="CSE" {% if user.department == 'CSE' %}selected{% endif %}>CSE</option>
                                        <option value="ECE" {% if user.department == 'ECE' %}selected{% endif %}>ECE</option>
                                        <option value="EEE" {% if user.department == 'EEE' %}selected{% endif %}>EEE</option>
                                        <option value="IT" {% if user.department == 'IT' %}selected{% endif %}>IT</option>
                                        <option value="ME" {% if user.department == 'ME' %}selected{% endif %}>ME</option>
                                        <option value="CE" {% if user.department == 'CE' %}selected{% endif %}>CE</option>
                                        <option value="CSBS" {% if user.department == 'CSBS' %}selected{% endif %}>CSBS</option>
                                        <option value="BS" {% if user.department == 'BS' %}selected{% endif %}>BS</option>
                                    </select>
                                    <input type="text" name="password" value="{{ user.password }}" placeholder="Password" class="border rounded px-2 py-1 mr-1" required>
                                    <button type="submit" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-1 px-3 rounded">Edit</button>
                                </form>
                                {% else %}
                                <form method="POST" action="{{ url_for('update_user_hods') }}" style="display:inline;">
                                    <input type="hidden" name="user_id" value="{{ user.user_id }}">
                                    <input type="hidden" name="user_type" value="{{ user.user_type }}">
                                    <input type="text" name="password" value="{{ user.password }}" placeholder="Password" class="border rounded px-2 py-1 mr-1" required>
                                    <button type="submit" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-1 px-3 rounded">Edit</button>
                                </form>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
        document.getElementById('user_type').addEventListener('change', function () {
            var facultyExtra = document.getElementById('faculty_extra');
            if (this.value === 'faculty') {
                facultyExtra.style.display = '';
            } else {
                facultyExtra.style.display = 'none';
            }
        });
    </script>
</body>
</html>
